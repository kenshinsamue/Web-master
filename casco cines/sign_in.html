        <html>
            <meta charset="UTF-8">
            <head>

                <title>Casco cines</title>
                <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
                <link rel="stylesheet" href="rectk_complicaciones.css" type="text/css" />
                <link rel="stylesheet" href="css/login.css" type="text/css" />
                <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
                <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>



            </head>



            <body>



               <nav class="navbar navbar-expand-lg navbar-dark ">


                 <a href="Index.html"><img src="imagenes/casco_cines.png"  alt="Cinque Terre " style="width: 100px;"></a>


               <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo02" aria-controls="navbarTogglerDemo02" aria-expanded="false" aria-label="Toggle navigation">

                  <span class="navbar-toggler-icon"></span>

               </button>

                 <!-- Creamos la barra para navegar entre paginas usando bootstrap -->
               <div class="collapse navbar-collapse" id="navbarTogglerDemo02">


                    <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
                        <li class="nav-item active">
    
                          <a class="nav-link" href="Top.html">Top <span class="sr-only">(current)</span></a>
    
                        </li>
                        <li class="nav-item active">
    
                            <a class="nav-link" href="categoria.html">Categoria <span class="sr-only">(current)</span></a>
    
                        </li>
                        <li class="nav-item active ">
    
                            <a class="nav-link " href="at_cliente.html">Atenci√≥n al cliente <span class="sr-only">(current)</span></a>
    
                        </li>

                    </ul>


                    <form class="form-inline my-2 my-lg-0">


                      <a class="navbar-brand " href="login.html">Log in</a>




                    </form>


                </div>


            </nav>




            <div>
               <!-- aca va un espacio -->
               </br>




            </div>
            	<div id="SignIn">

                    <div class="container">
                        <div id="SignIn-row" class="row justify-content-center align-items-center">
                            <div id="SignIn-column" class="col-md-6">
                                <div class="SignIn-box col-md-12">


                                    <form id="SignIn-form" class="form" action="" method="post">
                                        <h3 class="text-center text-info text-white ">Sign Up</h3>


                                        <div class="form-group">
                                            <label for="name" class="text-info text-white">Name:</label><br>
                                            <input type="text" name="name" id="name" class="form-control">
                                        </div>

                                         <div class="form-group">
                                            <label for="surname" class="text-info text-white">Surname:</label><br>
                                            <input type="text" name="surname" id="surname" class="form-control">
                                        </div>


                                        <div class="form-group"  id="error_login">
                                            <label for="username" class="text-info text-white">Username:</label><br>
                                            <input type="text" name="username" id="username" class="form-control">
                                        </div>

                                        <div class="form-group">
                                            <label for="inputPassword" class="text-info text-white">Password:</label><br>
                                            <input type="password" class="form-control" id="inputPassword">
                                        </div>

                                        <div class="form-group" id="error_email" >
                                            <label for="email" class="text-info text-white">Email:</label><br>
                                            <input type="text" name="email" id="email" class="form-control">
                                        </div>





                                        <div class=" text-center form-group ">


                                            <button type="button" id="sand-pls"  class="btn btn-danger">Registrate</button>



                                            <script src="https://www.gstatic.com/firebasejs/5.7.2/firebase.js"></script>
                                            <script>
                                              // Initialize Firebase
                                             var config = {
                                                apiKey: "AIzaSyBrwLumts2gkeLjgvjer9_f7lhY3NwZUow",
                                                authDomain: "sipc-54c0f.firebaseapp.com",
                                                databaseURL: "https://sipc-54c0f.firebaseio.com",
                                                projectId: "sipc-54c0f",
                                                storageBucket: "sipc-54c0f.appspot.com",
                                                messagingSenderId: "49051567985"
                                              };
                                              firebase.initializeApp(config);

                                              var database = firebase.database();
                                              const btn = document.getElementById("sand-pls");





                                            var erno_email=false;
                                            btn.addEventListener('click',e => {

                                                    var name = document.getElementById("name").value;                 // cogemos los valores del formulario
                                                    var surname = document.getElementById("surname").value;
                                                    var pass=document.getElementById("inputPassword").value;
                                                    var email = document.getElementById("email").value;
                                                    email=email.trim();                                // quitamos los espacios del email
                                                    var username =document.getElementById("username").value;            //          <-----

                                                    var correo=email.search("@");				// obtenemos la posicion del caracter @, sera -1 si no esta
                                                    var direccion=email.indexOf(".");			// obtenemos la posicion del caracter "."

                                                    
                                                    
                                                    if(correo == -1 || direccion ==-1 || correo < 3 || (direccion-correo)<3 || ((email.length-1)-direccion)<3 || email==""){
                                                    		// condiciones para verificar que cumple con los requisitos minimos de una direccion de correo electornico
                                                    		// si no los cumple:
                                                    		if( document.getElementById("Er_email") === null){	// verifica si el cuadro de error se ha mostrado, si no es asi
                                                    				
                                                    			var Eeamil=document.getElementById("error_email");		// crea una referencia con el contenedor
                                                    			Eeamil.insertAdjacentHTML("beforeend","<h6 class='text-danger' id='Er_email'>Formato de email no valido</h6>");
                                                    			//inserta codigo HTML con Javascript
                                                    		}
                                                    		

                                                    }


                                                    else{
                                                    	firebase.database().ref('/usuarios/' + username).once('value').then(function(snapshot) {


                                                          if(snapshot.exists()){

                                                              if(document.getElementById("error_show")=== null){
                                                                     var ejemplo = document.getElementById("error_login");

                                                                   ejemplo.insertAdjacentHTML("beforeend","<h6 class='text-danger' id='error_show'>Nombre de usuario ya cogido</h6>");


                                                                }


                                                          }

                                                          else{
                                                              firebase.database().ref('usuarios/' + username).set({
                                                                name: name,
                                                                surname: surname,
                                                                pass : pass,
                                                                correo: email,
                                                                img:"https://firebasestorage.googleapis.com/v0/b/sipc-54c0f.appspot.com/o/imagenes_usuarios%2Fdefault.png?alt=media&token=10187c9a-fe5c-4195-a60b-0f0fe4671dca"
                                                              });

                                                              document.cookie="username="+username;

                                                              location.href="Index.html";

                                                          }


                                                    });


                                                    }

                                             });


                                            </script>

                                        </div>

                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>




            </body>

        </html>
